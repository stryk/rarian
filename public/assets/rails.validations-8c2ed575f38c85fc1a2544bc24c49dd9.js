!function(){var i,e,t,a,n=[].indexOf||function(i){for(var e=0,t=this.length;t>e;e++)if(e in this&&this[e]===i)return e;return-1};i=jQuery,i.fn.disableClientSideValidations=function(){return ClientSideValidations.disable(this),this},i.fn.enableClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.enablers.form(this)}),this.filter(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)}),this},i.fn.resetClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.reset(this)}),this},i.fn.validate=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return i(this).enableClientSideValidations()}),this},i.fn.isValid=function(n){var r;return r=i(this[0]),r.is("form")?t(r,n):e(r,a(this[0].name,n))},a=function(i,e){return i=i.replace(/_attributes\]\[\w+\]\[(\w+)\]/g,"_attributes][][$1]"),e[i]||{}},t=function(e,t){var a;return e.trigger("form:validate:before.ClientSideValidations"),a=!0,e.find(ClientSideValidations.selectors.validate_inputs).each(function(){return i(this).isValid(t)||(a=!1),!0}),a?e.trigger("form:validate:pass.ClientSideValidations"):e.trigger("form:validate:fail.ClientSideValidations"),e.trigger("form:validate:after.ClientSideValidations"),a},e=function(e,t){var a,n,r,l,s,o,d;return e.trigger("element:validate:before.ClientSideValidations"),o=function(){return e.trigger("element:validate:pass.ClientSideValidations").data("valid",null)},l=function(i){return e.trigger("element:validate:fail.ClientSideValidations",i).data("valid",!1),!1},a=function(){return e.trigger("element:validate:after.ClientSideValidations").data("valid")!==!1},r=function(i){var a,n,r,s,o,d,u,c;s=!0;for(n in i)if(a=i[n],t[n]){for(c=t[n],d=0,u=c.length;u>d;d++)if(o=c[d],r=a.call(i,e,o)){s=l(r);break}if(!s)break}return s},n=e.attr("name").replace(/\[([^\]]*?)\]$/,"[_destroy]"),"1"===i("input[name='"+n+"']").val()?(o(),a()):e.data("changed")===!1?a():(e.data("changed",!1),s=ClientSideValidations.validators.local,d=ClientSideValidations.validators.remote,r(s)&&r(d)&&o(),a())},void 0===window.ClientSideValidations&&(window.ClientSideValidations={}),void 0===window.ClientSideValidations.forms&&(window.ClientSideValidations.forms={}),window.ClientSideValidations.selectors={inputs:':input:not(button):not([type="submit"])[name]:visible:enabled',validate_inputs:":input:enabled:visible[data-validate]",forms:"form[data-validate]"},window.ClientSideValidations.reset=function(e){var t,a;t=i(e),ClientSideValidations.disable(e);for(a in e.ClientSideValidations.settings.validators)e.ClientSideValidations.removeError(t.find("[name='"+a+"']"));return ClientSideValidations.enablers.form(e)},window.ClientSideValidations.disable=function(e){var t;return t=i(e),t.off(".ClientSideValidations"),t.is("form")?ClientSideValidations.disable(t.find(":input")):(t.removeData("valid"),t.removeData("changed"),t.filter(":input").each(function(){return i(this).removeAttr("data-validate")}))},window.ClientSideValidations.enablers={form:function(e){var t,a,n,r;t=i(e),e.ClientSideValidations={settings:window.ClientSideValidations.forms[t.attr("id")],addError:function(i,t){return ClientSideValidations.formBuilders[e.ClientSideValidations.settings.type].add(i,e.ClientSideValidations.settings,t)},removeError:function(i){return ClientSideValidations.formBuilders[e.ClientSideValidations.settings.type].remove(i,e.ClientSideValidations.settings)}},r={"submit.ClientSideValidations":function(i){return t.isValid(e.ClientSideValidations.settings.validators)?void 0:(i.preventDefault(),i.stopImmediatePropagation())},"ajax:beforeSend.ClientSideValidations":function(i){return i.target===this?t.isValid(e.ClientSideValidations.settings.validators):void 0},"form:validate:after.ClientSideValidations":function(i){return ClientSideValidations.callbacks.form.after(t,i)},"form:validate:before.ClientSideValidations":function(i){return ClientSideValidations.callbacks.form.before(t,i)},"form:validate:fail.ClientSideValidations":function(i){return ClientSideValidations.callbacks.form.fail(t,i)},"form:validate:pass.ClientSideValidations":function(i){return ClientSideValidations.callbacks.form.pass(t,i)}};for(n in r)a=r[n],t.on(n,a);return t.find(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)})},input:function(e){var t,a,n,r,l,s;a=i(e),l=e.form,t=i(l),s={"focusout.ClientSideValidations":function(){return i(this).isValid(l.ClientSideValidations.settings.validators)},"change.ClientSideValidations":function(){return i(this).data("changed",!0)},"element:validate:after.ClientSideValidations":function(e){return ClientSideValidations.callbacks.element.after(i(this),e)},"element:validate:before.ClientSideValidations":function(e){return ClientSideValidations.callbacks.element.before(i(this),e)},"element:validate:fail.ClientSideValidations":function(e,t){var a;return a=i(this),ClientSideValidations.callbacks.element.fail(a,t,function(){return l.ClientSideValidations.addError(a,t)},e)},"element:validate:pass.ClientSideValidations":function(e){var t;return t=i(this),ClientSideValidations.callbacks.element.pass(t,function(){return l.ClientSideValidations.removeError(t)},e)}};for(r in s)n=s[r],a.filter(":not(:radio):not([id$=_confirmation])").each(function(){return i(this).attr("data-validate",!0)}).on(r,n);return a.filter(":checkbox").on("click.ClientSideValidations",function(){return i(this).isValid(l.ClientSideValidations.settings.validators),!0}),a.filter("[id$=_confirmation]").each(function(){var e,a,s,o;if(e=i(this),a=t.find("#"+this.id.match(/(.+)_confirmation/)[1]+":input"),a[0]){s={"focusout.ClientSideValidations":function(){return a.data("changed",!0).isValid(l.ClientSideValidations.settings.validators)},"keyup.ClientSideValidations":function(){return a.data("changed",!0).isValid(l.ClientSideValidations.settings.validators)}},o=[];for(r in s)n=s[r],o.push(i("#"+e.attr("id")).on(r,n));return o}})}},window.ClientSideValidations.validators={all:function(){return jQuery.extend({},ClientSideValidations.validators.local,ClientSideValidations.validators.remote)},local:{presence:function(i,e){return/^\s*$/.test(i.val()||"")?e.message:void 0},acceptance:function(i,e){var t;switch(i.attr("type")){case"checkbox":if(!i.prop("checked"))return e.message;break;case"text":if(i.val()!==((null!=(t=e.accept)?t.toString():void 0)||"1"))return e.message}},format:function(i,e){var t;if(t=this.presence(i,e)){if(e.allow_blank===!0)return;return t}return e["with"]&&!e["with"].test(i.val())?e.message:e.without&&e.without.test(i.val())?e.message:void 0},numericality:function(e,t){var a,n,r,l,s,o,d;if(d=jQuery.trim(e.val()),!ClientSideValidations.patterns.numericality.test(d)){if(t.allow_blank===!0&&this.presence(e,{message:t.messages.numericality}))return;return t.messages.numericality}if(d=d.replace(new RegExp("\\"+ClientSideValidations.number_format.delimiter,"g"),"").replace(new RegExp("\\"+ClientSideValidations.number_format.separator,"g"),"."),t.only_integer&&!/^[+-]?\d+$/.test(d))return t.messages.only_integer;a={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="},s=i(e[0].form);for(n in a)if(o=a[n],null!=t[n]){if(!isNaN(parseFloat(t[n]))&&isFinite(t[n]))r=t[n];else{if(1!==s.find("[name*="+t[n]+"]").size())return;r=s.find("[name*="+t[n]+"]").val()}if(l=new Function("return "+d+" "+o+" "+r),!l())return t.messages[n]}return!t.odd||parseInt(d,10)%2?t.even&&parseInt(d,10)%2?t.messages.even:void 0:t.messages.odd},length:function(i,e){var t,a,n,r,l,s,o,d;if(d=e.js_tokenizer||"split('')",o=new Function("element","return (element.val()."+d+" || '').length")(i),t={is:"==",minimum:">=",maximum:"<="},a={},a.message=e.is?e.messages.is:e.minimum?e.messages.minimum:void 0,l=this.presence(i,a)){if(e.allow_blank===!0)return;return l}for(n in t)if(s=t[n],e[n]&&(r=new Function("return "+o+" "+s+" "+e[n]),!r()))return e.messages[n]},exclusion:function(i,e){var t,a,r,l,s;if(a=this.presence(i,e)){if(e.allow_blank===!0)return;return a}return e["in"]&&(s=i.val(),n.call(function(){var i,t,a,n;for(a=e["in"],n=[],i=0,t=a.length;t>i;i++)r=a[i],n.push(r.toString());return n}(),s)>=0)?e.message:e.range&&(t=e.range[0],l=e.range[1],i.val()>=t&&i.val()<=l)?e.message:void 0},inclusion:function(i,e){var t,a,r,l,s;if(a=this.presence(i,e)){if(e.allow_blank===!0)return;return a}if(e["in"]){if(s=i.val(),n.call(function(){var i,t,a,n;for(a=e["in"],n=[],i=0,t=a.length;t>i;i++)r=a[i],n.push(r.toString());return n}(),s)>=0)return;return e.message}if(e.range){if(t=e.range[0],l=e.range[1],i.val()>=t&&i.val()<=l)return;return e.message}},confirmation:function(i,e){return i.val()!==jQuery("#"+i.attr("id")+"_confirmation").val()?e.message:void 0},uniqueness:function(e,t){var a,n,r,l,s,o,d;return r=e.attr("name"),/_attributes\]\[\d/.test(r)&&(n=r.match(/^(.+_attributes\])\[\d+\](.+)$/),l=n[1],s=n[2],d=e.val(),l&&s&&(a=e.closest("form"),o=!0,a.find(':input[name^="'+l+'"][name$="'+s+'"]').each(function(){if(i(this).attr("name")!==r){if(i(this).val()===d)return o=!1,i(this).data("notLocallyUnique",!0);if(i(this).data("notLocallyUnique"))return i(this).removeData("notLocallyUnique").data("changed",!0)}}),!o))?t.message:void 0}},remote:{uniqueness:function(i,e){var t,a,n,r,l,s,o,d;if(n=ClientSideValidations.validators.local.presence(i,e)){if(e.allow_blank===!0)return;return n}if(t={},t.case_sensitive=!!e.case_sensitive,e.id&&(t.id=e.id),e.scope){t.scope={},d=e.scope;for(a in d)l=d[a],o=i.attr("name").replace(/\[\w+\]$/,"["+a+"]"),s=jQuery("[name='"+o+"']"),jQuery("[name='"+o+"']:checkbox").each(function(){return this.checked?s=this:void 0}),s[0]&&s.val()!==l?(t.scope[a]=s.val(),s.unbind("change."+i.id).bind("change."+i.id,function(){return i.trigger("change.ClientSideValidations"),i.trigger("focusout.ClientSideValidations")})):t.scope[a]=l}return/_attributes\]/.test(i.attr("name"))?(r=i.attr("name").match(/\[\w+_attributes\]/g).pop().match(/\[(\w+)_attributes\]/).pop(),r+=/(\[\w+\])$/.exec(i.attr("name"))[1]):r=i.attr("name"),e["class"]&&(r=e["class"]+"["+r.split("[")[1]),t[r]=i.val(),200===jQuery.ajax({url:ClientSideValidations.remote_validators_url_for("uniqueness"),data:t,async:!1,cache:!1}).status?e.message:void 0}}},window.ClientSideValidations.remote_validators_url_for=function(i){return null!=ClientSideValidations.remote_validators_prefix?"//"+window.location.host+ClientSideValidations.remote_validators_prefix+"/validators/"+i:"//"+window.location.host+"/validators/"+i},window.ClientSideValidations.disableValidators=function(){var i,e,t,a;if(void 0!==window.ClientSideValidations.disabled_validators){t=window.ClientSideValidations.validators.remote,a=[];for(e in t)i=t[e],-1!==window.ClientSideValidations.disabled_validators.indexOf(e)?a.push(delete window.ClientSideValidations.validators.remote[e]):a.push(void 0);return a}},window.ClientSideValidations.formBuilders={"ActionView::Helpers::FormBuilder":{add:function(e,t,a){var n,r,l,s;return n=i(e[0].form),e.data("valid")!==!1&&null==n.find("label.message[for='"+e.attr("id")+"']")[0]&&(r=jQuery(t.input_tag),s=jQuery(t.label_tag),l=n.find("label[for='"+e.attr("id")+"']:not(.message)"),e.attr("autofocus")&&e.attr("autofocus",!1),e.before(r),r.find("span#input_tag").replaceWith(e),r.find("label.message").attr("for",e.attr("id")),s.find("label.message").attr("for",e.attr("id")),s.insertAfter(l),s.find("label#label_tag").replaceWith(l)),n.find("label.message[for='"+e.attr("id")+"']").text(a)},remove:function(e,t){var a,n,r,l,s;return n=i(e[0].form),a=jQuery(t.input_tag).attr("class"),r=e.closest("."+a.replace(" ",".")),l=n.find("label[for='"+e.attr("id")+"']:not(.message)"),s=l.closest("."+a),r[0]?(r.find("#"+e.attr("id")).detach(),r.replaceWith(e),l.detach(),s.replaceWith(l)):void 0}}},window.ClientSideValidations.patterns={numericality:/^(-|\+)?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/},window.ClientSideValidations.callbacks={element:{after:function(){},before:function(){},fail:function(i,e,t){return t()},pass:function(i,e){return e()}},form:{after:function(){},before:function(){},fail:function(){},pass:function(){}}},i(function(){return ClientSideValidations.disableValidators(),i(ClientSideValidations.selectors.forms).validate()})}.call(this),function(){$(document).on("page:change",function(){return $("div.control-group").focusout(function(){return $("div.control-group").hasClass("error")?void 0:$(this).addClass("success")})})}.call(this),ClientSideValidations.formBuilders["SimpleForm::FormBuilder"]={add:function(i,e,t){var a,n;return e.wrapper_tag=".control-group",e.error_tag="span",e.error_class="help-inline",e.wrapper_error_class="error",e.wrapper_success="success",i.data("valid")!==!1?(n=i.closest(e.wrapper_tag),n.removeClass(e.wrapper_success),n.addClass(e.wrapper_error_class),a=$("<"+e.error_tag+"/>",{"class":e.error_class,text:t}),n.find(".controls").append(a)):(n=i.closest(e.wrapper_tag),n.addClass(e.wrapper_error_class),i.parent().find(""+e.error_tag+"."+e.error_class).text(t))},remove:function(i,e){var t,a;return e.wrapper_tag=".control-group",e.error_tag="span",e.error_class="help-inline",e.wrapper_error_class="error",e.wrapper_success="success",a=i.closest(""+e.wrapper_tag+"."+e.wrapper_error_class),a.removeClass(e.wrapper_error_class),a.addClass(e.wrapper_success),t=a.find(""+e.error_tag+"."+e.error_class),t.remove()}};