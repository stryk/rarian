!function(e){function a(){this.regional=[],this.regional[""]={feedbackText:"{r} characters remaining ({m} maximum)",overflowText:"{o} characters too many ({m} maximum)"},this._defaults={max:200,truncate:!0,showFeedback:!0,feedbackTarget:null,onFull:null},e.extend(this._defaults,this.regional[""])}function t(a,t){return"option"==a&&(0==t.length||1==t.length&&"string"==typeof t[0])?!0:e.inArray(a,s)>-1}e.extend(a.prototype,{markerClassName:"hasMaxLength",propertyName:"maxlength",_feedbackClass:"maxlength-feedback",_fullClass:"maxlength-full",_overflowClass:"maxlength-overflow",_disabledClass:"maxlength-disabled",setDefaults:function(a){return e.extend(this._defaults,a||{}),this},_attachPlugin:function(a,t){if(a=e(a),!a.hasClass(this.markerClassName)){var s={options:e.extend({},this._defaults),feedbackTarget:e([])};a.addClass(this.markerClassName).data(this.propertyName,s).bind("keypress."+this.propertyName,function(a){if(!s.options.truncate)return!0;var t=String.fromCharCode(void 0==a.charCode?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||"\0"==t||e(this).val().length<s.options.max}).bind("keyup."+this.propertyName,function(){i._checkLength(e(this))}),this._optionPlugin(a,t)}},_optionPlugin:function(a,t,s){a=e(a);var i=a.data(this.propertyName);if(!t||"string"==typeof t&&null==s){var r=t;return t=(i||{}).options,t&&r?t[r]:t}if(a.hasClass(this.markerClassName)){if(t=t||{},"string"==typeof t){var r=t;t={},t[r]=s}e.extend(i.options,t),i.feedbackTarget.length>0&&(i.hadFeedbackTarget?i.feedbackTarget.empty().val("").removeClass(this._feedbackClass+" "+this._fullClass+" "+this._overflowClass):i.feedbackTarget.remove(),i.feedbackTarget=e([])),i.options.showFeedback&&(i.hadFeedbackTarget=!!i.options.feedbackTarget,i.feedbackTarget=e.isFunction(i.options.feedbackTarget)?i.options.feedbackTarget.apply(a[0],[]):i.options.feedbackTarget?e(i.options.feedbackTarget):e("<span></span>").insertAfter(a),i.feedbackTarget.addClass(this._feedbackClass)),a.unbind("mouseover."+this.propertyName+" focus."+this.propertyName+"mouseout."+this.propertyName+" blur."+this.propertyName),"active"==i.options.showFeedback&&(a.bind("mouseover."+this.propertyName,function(){i.feedbackTarget.css("visibility","visible")}).bind("mouseout."+this.propertyName,function(){i.focussed||i.feedbackTarget.css("visibility","hidden")}).bind("focus."+this.propertyName,function(){i.focussed=!0,i.feedbackTarget.css("visibility","visible")}).bind("blur."+this.propertyName,function(){i.focussed=!1,i.feedbackTarget.css("visibility","hidden")}),i.feedbackTarget.css("visibility","hidden")),this._checkLength(a)}},_curLengthPlugin:function(e){var a=e.data(this.propertyName),t=e.val(),s=t.replace(/\r\n/g,"~~").replace(/\n/g,"~~").length;return{used:s,remaining:a.options.max-s}},_checkLength:function(a){var t=a.data(this.propertyName),s=a.val(),i=s.replace(/\r\n/g,"~~").replace(/\n/g,"~~").length;if(a.toggleClass(this._fullClass,i>=t.options.max).toggleClass(this._overflowClass,i>t.options.max),i>t.options.max&&t.options.truncate){var r=a.val().split(/\r\n|\n/);s="";for(var o=0;s.length<t.options.max&&o<r.length;)s+=r[o].substring(0,t.options.max-s.length)+"\r\n",o++;a.val(s.substring(0,t.options.max)),a[0].scrollTop=a[0].scrollHeight,i=t.options.max}t.feedbackTarget.toggleClass(this._fullClass,i>=t.options.max).toggleClass(this._overflowClass,i>t.options.max);var n=(i>t.options.max?t.options.overflowText:t.options.feedbackText).replace(/\{c\}/,i).replace(/\{m\}/,t.options.max).replace(/\{r\}/,t.options.max-i).replace(/\{o\}/,i-t.options.max);try{t.feedbackTarget.text(n)}catch(l){}try{t.feedbackTarget.val(n)}catch(l){}i>=t.options.max&&e.isFunction(t.options.onFull)&&t.options.onFull.apply(a,[i>t.options.max])},_enablePlugin:function(a){if(a=e(a),a.hasClass(this.markerClassName)){a.prop("disabled",!1).removeClass(this.propertyName+"-disabled");var t=a.data(this.propertyName);t.feedbackTarget.removeClass(this.propertyName+"-disabled")}},_disablePlugin:function(a){if(a=e(a),a.hasClass(this.markerClassName)){a.prop("disabled",!0).addClass(this.propertyName+"-disabled");var t=a.data(this.propertyName);t.feedbackTarget.addClass(this.propertyName+"-disabled")}},_destroyPlugin:function(a){if(a=e(a),a.hasClass(this.markerClassName)){var t=a.data(this.propertyName);t.feedbackTarget.length>0&&(t.hadFeedbackTarget?t.feedbackTarget.empty().val("").css("visibility","visible").removeClass(this._feedbackClass+" "+this._fullClass+" "+this._overflowClass):t.feedbackTarget.remove()),a.removeClass(this.markerClassName+" "+this._fullClass+" "+this._overflowClass).removeData(this.propertyName).unbind("."+this.propertyName)}}});var s=["curLength"];e.fn.maxlength=function(e){var a=Array.prototype.slice.call(arguments,1);return t(e,a)?i["_"+e+"Plugin"].apply(i,[this[0]].concat(a)):this.each(function(){if("string"==typeof e){if(!i["_"+e+"Plugin"])throw"Unknown method: "+e;i["_"+e+"Plugin"].apply(i,[this].concat(a))}else i._attachPlugin(this,e||{})})};var i=e.maxlength=new a}(jQuery);